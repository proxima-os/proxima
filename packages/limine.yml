sources:
  - name: limine
    version: '9.2.3'
    subdir: ports
    url: 'https://github.com/limine-bootloader/limine/releases/download/v9.2.3/limine-9.2.3.tar.xz'
    checksum: 'blake2b:733082c3a855bcf2d260104d4b97699f9614bf953bff91dda6b4386c95b9b328429905078968efb4c12502307fb52d3d760f10557dbf020421f4da92e792a264'
    format: 'tar.xz'
    extract_path: 'limine-9.2.3'

tools:
  - name: host-limine
    architecture: '@OPTION:arch@'
    from_source: limine
    tools_required:
      - host-gcc
    configure:
      - args: |
          do_config () {
              '@THIS_SOURCE_DIR@/configure' '--prefix=@PREFIX@' "$@"
          }
          case '@OPTION:arch@' in
          x86_64) do_config --enable-bios --enable-bios-cd --enable-bios-pxe \
                            --enable-uefi-ia32 --enable-uefi-x86-64 --enable-uefi-cd
                  ;;
          *)      do_config ;;
          esac
        environ:
          TOOLCHAIN_FOR_TARGET: gnu
          AR_FOR_TARGET: '@OPTION:arch@-unknown-proxima-gcc-ar'
          CC_FOR_TARGET: '@OPTION:arch@-unknown-proxima-gcc'
          LD_FOR_TARGET: '@OPTION:arch@-unknown-proxima-ld'
          OBJCOPY_FOR_TARGET: '@OPTION:arch@-unknown-proxima-objcopy'
          OBJDUMP_FOR_TARGET: '@OPTION:arch@-unknown-proxima-objdump'
          READELF_FOR_TARGET: '@OPTION:arch@-unknown-proxima-readelf'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', '-j@PARALLELISM@', 'install']
